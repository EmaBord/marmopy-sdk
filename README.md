# Marmopy-sdk

# Description
Marmopy-sdk helps python developers to consume Marmo Relayer.

# Simple Summary
Allowing users to sign messages to show intent of execution, but allowing a third party relayer to execute them is an emerging pattern being used in many projects. 
This pattern simplifies the integration with any Ethereum based platform. 
Marmo relayer: (https://github.com/ripio/marmo-relayer). 

# Abstract
### User pain points:
> - Users don't want to think about ether
> - Users want to be able to pay for transactions using whatever they have 
> - Users donâ€™t want to download apps/extensions (at least on the desktop) to connect to their apps

# Ecosystem Graph
![](./images/01.png)

###### General WIKI ecosystem.
- Work in progress.
###### API layer
- Marmo relayer doc: (https://github.com/ripio/marmo-relayer/blob/master/README.md)
###### CORE layer
- Marmo contracts doc: (https://github.com/ripio/marmo-contracts/blob/master/README.md)

# Features
- Complete implementation of Intent functionality for Marmo relay.
- Ethereum wallet support.
- Comprehensive integration tests demonstrating a number of the above scenarios.

##### Runtime dependencies:

- web3py (https://pypi.org/project/web3/).

# Getting started

##### Prerequisites
* Python2 or Python3

Pip install from git url:

```shell
pip install git+https://github.com/majd1239/marmopy-sdk
```

### Intent Flowchart
![](./images/02.png)

###### Dependencies
> - T0  -> -
> - T1  -> - 
> - T2  -> T1
> - T3  -> T1
> - T4  -> T1
> - T5  -> T1, T4
> - T6  -> T2
> - T7  -> T2
> - T8  -> T2
> - T9  -> T3
> - T10 -> T4
> - T11 -> T5
> - T12 -> T6
> - T13 -> T7
> - T14 -> T8
> - T15 -> T9
> - T16 -> T10
> - T17 -> T10
> - T18 -> T11
> - T19 -> T13
> - T20 -> T14
> - T21 -> T15
> - T22 -> T18
> - T23 -> T19
> - T24 -> T21
> - T25 -> T22
> - T26 -> T12, T23, T20, T15
> - T27 -> T24
> - T28 -> T25
> - T29 -> T27


### Build a intent
```python
from marmopy import Intent,Credentials,IntentAction

class Contract:
    def __init__(self,contractAddress):
        self.contractAddress = contractAddress
        
    @IntentAction
    def transfer(self, to='address', value='uint256') : return 'bool'
    
    
tokenContractAddress = "0x2f45b6fb2f28a73f110400386da31044b2e953d4" #RCN TOKEN
to = "0x7F5EB5bB5cF88cfcEe9613368636f458800e62CB"

erc20 = Contract(tokenContractAddress)  #example of ERC20 contract with IntentActions injections. 

value = 1

intentAction = erc20.transfer(to,value)

credentials = Credentials("Your private key here");

# Intents ids 32 bits hashestrings dependencies
dependencies = ["0xee2e1b62b008e27a5a3d66352f87e760ed85e723b6834e622f38b626090f536e",
                "0x6b67aac6eda8798297b1591da36a215bfbe1fed666c4676faf5a214d54e9e928"]

intent = Intent(intentAction=intentAction, signer=credentials.getAddress())
```

### Sign a intent
```python
signedIntent = intent.sign(credentials);
```

###  Send a intent
```python
import requests

requests.post("http://ec2-3-16-37-20.us-east-2.compute.amazonaws.com/relay",json=signedIntent)  #relay url

```

# Structure of builder

| Name                  | Type/Format   | Mandatory | Default       | Description                                              |
| --------              | --------      | --------  | --------      | --------                                                 |
| id                    | hexstring     | yes       | Autogenerated | A unique identifier for the intent.                      |
| dependencies          | hexstring[]   | no        | Empty         | Define a correlation id for intent.                      |
| signer                | hexstring     | yes       | -             | The address of the signer that sign the intent.          |
| wallet                | hexstring     | no        | Autogenerated | Contract address or Marmo instance.                      |
| salt                  | hexstring     | no        | 0x0           | Use to send the same intent many times if needed.        |
| minGasLimit           | Int           | no        | 0             | Minimum gas price.                                       |
| maxGasPrice           | Int           | no        | 99999999      | Maximum gas price.                                       |
| intentAction          | IntentAction  | yes       | 0x0           | IntentAction Example -> marmopy-sdk.examples.ERC20. 
|
| expiration            | Int           | no        | 15            | 15 days for expiration
|                                                                                                                           


# Run Tests

First install nose -> pip install nose
Then run:

```shell
 nosetests tests/*
 ```
